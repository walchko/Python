#!/usr/bin/python

import ip_geolocate as geo
import local_connected_ip as lc
import make_map5 as mm
#from subprocess import check_output

def main():
	
 	ret = lc.port_check()
# 	print ret
 	ips=lc.parse_rec(ret)
# 	print ips
#	return 0

	#ips = [['Finder', 'localhost', '51848', '26164'], ['Finder', 'localhost', '51848', '26164'], ['Mail', 'imap5.mail.vip.bf1.yahoo.com', '59753', 'imaps'], ['Mail', '17.172.34.14', '59421', 'imaps'], ['Mail', 'ig-in-f108.1e100.net', '59433', 'imaps'], ['Mail', 'imap4.mail.vip.gq1.yahoo.com', '59403', 'imaps'], ['Mail', 'ig-in-f108.1e100.net', '59399', 'imaps'], ['Mail', 'imap4.mail.vip.gq1.yahoo.com', '59403', 'imaps'], ['Mail', '17.172.34.90', '59404', 'imaps'], ['Mail', '17.172.34.14', '59421', 'imaps'], ['Mail', '17.172.34.90', '59404', 'imaps'], ['Mail', 'imap5.mail.vip.ne1.yahoo.com', '59533', 'imaps'], ['Mail', 'ig-in-f108.1e100.net', '59433', 'imaps'], ['Mail', 'ig-in-f109.1e100.net', '59417', 'imaps'], ['Mail', 'imap5.mail.vip.ne1.yahoo.com', '59533', 'imaps'], ['Mail', 'imap5.mail.vip.bf1.yahoo.com', '59753', 'imaps'], ['Mail', 'ig-in-f109.1e100.net', '59417', 'imaps'], ['Mail', '17.172.34.45', '59428', 'imaps'], ['Mail', '17.172.34.45', '59428', 'imaps'], ['Mail', 'ig-in-f108.1e100.net', '59422', 'imaps'], ['Mail', '17.172.34.45', '59419', 'imaps'], ['Mail', 'ig-in-f108.1e100.net', '59422', 'imaps'], ['Mail', '17.172.34.45', '59419', 'imaps'], ['Mail', 'ig-in-f108.1e100.net', '59399', 'imaps'], ['Dropbox', 'sjd-rb12-8b.sjc.dropbox.com', '59394', 'http'], ['Dropbox', 'localhost', '26164', '51848'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60019', 'http'], ['com.apple', 'bbc-vip115.telhc.bbc.co.uk', '59973', 'http'], ['com.apple', 'bbc-vip015.cwwtf.bbc.co.uk', '59963', 'http'], ['com.apple', 'bbc-vip015.cwwtf.bbc.co.uk', '60000', 'http'], ['com.apple', 'den03s05-in-f13.1e100.net', '60001', 'http'], ['com.apple', 'den03s05-in-f28.1e100.net', '59996', 'http'], ['com.apple', 'dfw06s27-in-f24.1e100.net', '59960', 'https'], ['com.apple', 'dfw06s27-in-f24.1e100.net', '59960', 'https'], ['com.apple', 'bbc-vip015.cwwtf.bbc.co.uk', '59963', 'http'], ['com.apple', 'den03s05-in-f28.1e100.net', '59996', 'http'], ['com.apple', 'ec2-23-23-159-99.compute-1.amazonaws.com', '59894', 'http'], ['com.apple', 'den03s05-in-f13.1e100.net', '59998', 'http'], ['com.apple', 'fmt-vip58.telhc.bbc.co.uk', '59965', 'https'], ['com.apple', 'fmt-vip58.telhc.bbc.co.uk', '59965', 'https'], ['com.apple', 'a23-3-68-145.deploy.static.akamaitechnologies.com', '59966', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59969', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59968', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59967', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59968', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59967', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59969', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59971', 'http'], ['com.apple', 'bbc-vip015.cwwtf.bbc.co.uk', '60000', 'http'], ['com.apple', 'dfw06s38-in-f24.1e100.net', '59961', 'https'], ['com.apple', 'dfw06s41-in-f23.1e100.net', '59956', 'https'], ['com.apple', 'a184-84-180-43.deploy.static.akamaitechnologies.com', '59997', 'http'], ['com.apple', 'dfw06s38-in-f24.1e100.net', '59961', 'https'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59970', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59970', 'http'], ['com.apple', 'a23-3-68-136.deploy.static.akamaitechnologies.com', '59971', 'http'], ['com.apple', 'a184-84-180-43.deploy.static.akamaitechnologies.com', '59997', 'http'], ['com.apple', 'a23-3-68-145.deploy.static.akamaitechnologies.com', '59966', 'http'], ['com.apple', 'a23-7-65-120.deploy.static.akamaitechnologies.com', '59972', 'http'], ['com.apple', 'bbc-vip115.telhc.bbc.co.uk', '59973', 'http'], ['com.apple', 'a23-7-65-120.deploy.static.akamaitechnologies.com', '59972', 'http'], ['com.apple', 'a23-3-68-138.deploy.static.akamaitechnologies.com', '59992', 'http'], ['com.apple', 'den03s05-in-f28.1e100.net', '59993', 'http'], ['com.apple', 'bbc-vip019.cwwtf.bbc.co.uk', '59974', 'http'], ['com.apple', 'dfw06s41-in-f8.1e100.net', '59995', 'https'], ['com.apple', 'a23-3-68-107.deploy.static.akamaitechnologies.com', '59975', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '59976', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '59976', 'http'], ['com.apple', 'ec2-23-23-159-99.compute-1.amazonaws.com', '59894', 'http'], ['com.apple', 'den03s05-in-f13.1e100.net', '60001', 'http'], ['com.apple', 'den03s05-in-f13.1e100.net', '59979', 'http'], ['com.apple', 'bbc-vip019.cwwtf.bbc.co.uk', '59974', 'http'], ['com.apple', 'a23-3-68-107.deploy.static.akamaitechnologies.com', '59975', 'http'], ['com.apple', 'den03s05-in-f13.1e100.net', '59998', 'http'], ['com.apple', 'den03s05-in-f13.1e100.net', '59979', 'http'], ['com.apple', 'den03s05-in-f28.1e100.net', '59981', 'http'], ['com.apple', 'a184-84-180-43.deploy.static.akamaitechnologies.com', '59999', 'http'], ['com.apple', 'den03s05-in-f28.1e100.net', '59981', 'http'], ['com.apple', '174.35.36.34', '59982', 'http'], ['com.apple', 'den03s05-in-f28.1e100.net', '59993', 'http'], ['com.apple', '174.35.36.34', '59982', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59983', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59983', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59984', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59985', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59985', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59984', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59986', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59987', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59987', 'http'], ['com.apple', 'den03s05-in-f18.1e100.net', '59955', 'https'], ['com.apple', '8.39.37.21', '59991', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59988', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59986', 'http'], ['com.apple', 'a23-3-68-209.deploy.static.akamaitechnologies.com', '59988', 'http'], ['com.apple', 'a23-7-64-143.deploy.static.akamaitechnologies.com', '59990', 'http'], ['com.apple', 'a23-7-64-143.deploy.static.akamaitechnologies.com', '59990', 'http'], ['com.apple', 'a184-84-180-43.deploy.static.akamaitechnologies.com', '59999', 'http'], ['com.apple', '8.39.37.21', '59991', 'http'], ['com.apple', 'a23-3-68-138.deploy.static.akamaitechnologies.com', '59992', 'http'], ['com.apple', 'a23-3-68-129.deploy.static.akamaitechnologies.com', '59994', 'http'], ['com.apple', 'a23-3-68-129.deploy.static.akamaitechnologies.com', '59994', 'http'], ['com.apple', 'dfw06s27-in-f0.1e100.net', '60003', 'http'], ['com.apple', 'dfw06s41-in-f8.1e100.net', '59995', 'https'], ['com.apple', 'dfw06s27-in-f0.1e100.net', '60003', 'http'], ['com.apple', '74.201.141.140', '60005', 'http'], ['com.apple', 'a23-3-68-137.deploy.static.akamaitechnologies.com', '60006', 'http'], ['com.apple', '98.124.156.54', '60014', 'http'], ['com.apple', 'den03s05-in-f18.1e100.net', '59959', 'https'], ['com.apple', 'a23-3-68-137.deploy.static.akamaitechnologies.com', '60006', 'http'], ['com.apple', 'dfw06s41-in-f23.1e100.net', '59956', 'https'], ['com.apple', '74.201.141.140', '60005', 'http'], ['com.apple', '74.201.141.140', '60007', 'http'], ['com.apple', '138.108.6.20', '60008', 'http'], ['com.apple', 'static.test.bbc.co.uk', '60017', 'http'], ['com.apple', '*.112.2o7.net', '60009', 'http'], ['com.apple', '*.112.2o7.net', '60009', 'http'], ['com.apple', 'ec2-54-183-43-162.us-west-1.compute.amazonaws.com', '60010', 'http'], ['com.apple', 'ec2-54-183-43-162.us-west-1.compute.amazonaws.com', '60010', 'http'], ['com.apple', '74.201.141.140', '60007', 'http'], ['com.apple', '138.108.6.20', '60008', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60015', 'http'], ['com.apple', 'den03s05-in-f18.1e100.net', '59955', 'https'], ['com.apple', 'dfw06s17-in-f10.1e100.net', '59957', 'https'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60015', 'http'], ['com.apple', 'static.test.bbc.co.uk', '60017', 'http'], ['com.apple', 'dfw06s17-in-f10.1e100.net', '59957', 'https'], ['com.apple', 'den03s05-in-f18.1e100.net', '59959', 'https'], ['com.apple', '98.124.156.54', '60014', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60023', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60020', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60020', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60021', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60021', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60022', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60022', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60023', 'http'], ['com.apple', 'a23-4-145-199.deploy.static.akamaitechnologies.com', '60019', 'http'], ['com.apple', 'den03s05-in-f25.1e100.net', '59903', 'http'], ['com.apple', 'den03s05-in-f25.1e100.net', '59903', 'http']]

	pts = geo.locate_ip(ips)
	#print pts
	
	map = mm.create(pts)
	mm.printMap(map)

if __name__ == "__main__":
	main()